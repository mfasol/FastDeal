CREATE OR REPLACE VIEW V_SALES_CONTRIBUTION_BY_PRODUCT AS
  (SELECT PRODUCT_KEY,
     COUNT(ITEM_ID) AS SALES_NUM,
     ROUND(SUM(SALES),2) AS TOT_SALES,
     ROUND(SUM(COS),2) AS TOT_COS,
     ROUND(SUM(PROFIT),2) AS TOT_GP,
     ROUND(AVG(SALES),2) AS AVG_SALE,
     ROUND(AVG(COS),2) AS AVG_COS,
     ROUND(AVG(PROFIT),2) AS AVG_GP
  FROM V_SALES_CONTRIBUTION GROUP BY PRODUCT_KEY)
  UNION ALL
  (SELECT 'TOTAL',
      COUNT(ITEM_ID) AS SALES_NUM,
      ROUND(SUM(SALES),2) AS TOT_SALES,
      ROUND(SUM(COS),2) AS TOT_COS,
      ROUND(SUM(PROFIT),2) AS TOT_GP,
      ROUND(AVG(SALES),2) AS AVG_SALE,
      ROUND(AVG(COS),2) AS AVG_COS,
      ROUND(AVG(PROFIT),2) AS AVG_GP
  FROM V_SALES_CONTRIBUTION)
