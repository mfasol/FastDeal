CREATE OR REPLACE FORCE VIEW PUBLIC.V_INVENTORY_EVALUATOR(PRODUCT, TOTAL_VALUE, QUANTITY) AS
SELECT
    PRODUCT,
    ROUND(SUM(CASE WHEN (TRANSACTION_STATUS IS NULL) THEN ITEM_COS ELSE 0 END), 2) AS TOTAL_VALUE,
    SUM(CASE WHEN (TRANSACTION_STATUS IS NULL) THEN 1 ELSE 0 END) AS QUANTITY
FROM (
    SELECT
        INVENTORY_ITEMS_GB_AMAZON.PRODUCT_KEY AS PRODUCT,
      INVENTORY_ITEMS_GB_AMAZON.CONCATENATED_PRIMARY_KEY AS KEY,
        SALES_LEDGER.TRANSACTION_DATE,
        SALES_LEDGER.TRANSACTION_STATUS,
        INVENTORY_ITEMS_GB_AMAZON.ITEM_COS
    FROM PUBLIC.INVENTORY_ITEMS_GB_AMAZON
        /* PUBLIC.INVENTORY_ITEMS_GB_AMAZON.tableScan */
    LEFT  JOIN (
        PUBLIC.SALES_LEDGER
            /* PUBLIC.SALES_LEDGER.tableScan */
    ) ON INVENTORY_ITEMS_GB_AMAZON.CONCATENATED_PRIMARY_KEY = SALES_LEDGER.ITEM_ID
) _0
    /* SELECT
        INVENTORY_ITEMS_GB_AMAZON.PRODUCT_KEY AS PRODUCT,
        SALES_LEDGER.TRANSACTION_DATE,
        SALES_LEDGER.TRANSACTION_STATUS,
        INVENTORY_ITEMS_GB_AMAZON.ITEM_COS
    FROM PUBLIC.INVENTORY_ITEMS_GB_AMAZON
        /++ PUBLIC.INVENTORY_ITEMS_GB_AMAZON.tableScan ++/
    LEFT OUTER JOIN (
        PUBLIC.SALES_LEDGER
            /++ PUBLIC.SALES_LEDGER.tableScan ++/
    ) ON INVENTORY_ITEMS_GB_AMAZON.CONCATENATED_PRIMARY_KEY = SALES_LEDGER.ITEM_ID
     */
GROUP BY PRODUCT