View for purchase ledger reconciliation test
CREATE OR REPLACE FORCE VIEW PUBLIC.V_PURCHASE_LEDGER_SUMMARY_BY_SUPPLIER(SUPPLIER_KEY, NET) AS
  SELECT

    SUPPLIER_KEY,

    ROUND(SUM(PRICE), 2)               AS NET
  FROM PUBLIC.PURCHASE_LEDGER
  /* PUBLIC.PURCHASE_LEDGER.tableScan */
  WHERE UPDATE_LOCK = FALSE
  GROUP BY SUPPLIER_KEY
  ORDER BY 1
